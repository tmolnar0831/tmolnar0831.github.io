<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Tom's IT Cafe</title><link href="https://tmolnar0831.github.io/" rel="alternate"></link><link href="https://tmolnar0831.github.io/feeds/all.atom.xml" rel="self"></link><id>https://tmolnar0831.github.io/</id><updated>2022-05-02T15:55:00+02:00</updated><entry><title>How to backup and restore a distro on WSL</title><link href="https://tmolnar0831.github.io/how-to-backup-and-restore-wsl.html" rel="alternate"></link><published>2022-05-02T00:00:00+02:00</published><updated>2022-05-02T00:00:00+02:00</updated><author><name>Tamas Molnar</name></author><id>tag:tmolnar0831.github.io,2022-05-02:/how-to-backup-and-restore-wsl.html</id><summary type="html">&lt;p&gt;Follow the process on my &lt;a href="https://youtu.be/dx2WoQo8hho"&gt;YouTube video&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Backing up and restoring WSL distros is easier than anyone can think! It is simply an export of the stopped distro that can be moved on an external disk or share. Restoring a backup is importing the generated tar archive.&lt;/p&gt;
&lt;p&gt;Moreover we can …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Follow the process on my &lt;a href="https://youtu.be/dx2WoQo8hho"&gt;YouTube video&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Backing up and restoring WSL distros is easier than anyone can think! It is simply an export of the stopped distro that can be moved on an external disk or share. Restoring a backup is importing the generated tar archive.&lt;/p&gt;
&lt;p&gt;Moreover we can add &lt;strong&gt;multiple instances&lt;/strong&gt; of the same distro with exporting then importing it. With this let's say we can have three different Debian WSL boxes.&lt;/p&gt;
&lt;p&gt;To list our current distros use the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wsl --list --verbose
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;It will have an output something like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;  NAME          STATE           VERSION
* Debian        Running         2
  kali-linux    Stopped         2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To terminate a distro use the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wsl --terminate kali-linux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code&gt;kali-linux&lt;/code&gt; is the distro name from the list command above!&lt;/p&gt;
&lt;h1&gt;Backup a WSL distro&lt;/h1&gt;
&lt;p&gt;Backing up a WSL distro happens with the &lt;code&gt;--export&lt;/code&gt; option of the &lt;code&gt;wsl&lt;/code&gt; command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wsl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="k"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kali&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;\&lt;span class="n"&gt;home_lab&lt;/span&gt;\&lt;span class="n"&gt;Kali_WSL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The command will create a tar archive at the defined place.&lt;/p&gt;
&lt;h1&gt;Restore a WSL distro&lt;/h1&gt;
&lt;p&gt;Restoring an image happens with the &lt;code&gt;--import&lt;/code&gt; option.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wsl&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;kali&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;restored&lt;/span&gt; &lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;\&lt;span class="n"&gt;home_lab&lt;/span&gt;\ &lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;\&lt;span class="n"&gt;home_lab&lt;/span&gt;\&lt;span class="n"&gt;Kali_WSL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The command will restore the saved state of our WSL distro.&lt;/p&gt;</content><category term="Windows"></category><category term="windows"></category><category term="wsl"></category><category term="howto"></category></entry><entry><title>Installing Apache2 on Debian linux</title><link href="https://tmolnar0831.github.io/installing-apache2-on-debian-linux.html" rel="alternate"></link><published>2022-04-28T16:00:00+02:00</published><updated>2022-05-02T15:55:00+02:00</updated><author><name>Tamas Molnar</name></author><id>tag:tmolnar0831.github.io,2022-04-28:/installing-apache2-on-debian-linux.html</id><summary type="html">&lt;h1&gt;Installing Apache2 on Debian 11&lt;/h1&gt;
&lt;p&gt;Follow the process on my &lt;a href="https://www.youtube.com/watch?v=uvbACgn_AWA"&gt;YouTube&lt;/a&gt; video!&lt;/p&gt;
&lt;p&gt;The expected outcome is &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;To open a browser&lt;/li&gt;
&lt;li&gt;Type the IP address of the machine (DNS configuration is a topic for later)&lt;/li&gt;
&lt;li&gt;It must serve a new, custom html file called &lt;code&gt;index.html&lt;/code&gt; with our string &lt;code&gt;"Hello, How …&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h1&gt;Installing Apache2 on Debian 11&lt;/h1&gt;
&lt;p&gt;Follow the process on my &lt;a href="https://www.youtube.com/watch?v=uvbACgn_AWA"&gt;YouTube&lt;/a&gt; video!&lt;/p&gt;
&lt;p&gt;The expected outcome is &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;To open a browser&lt;/li&gt;
&lt;li&gt;Type the IP address of the machine (DNS configuration is a topic for later)&lt;/li&gt;
&lt;li&gt;It must serve a new, custom html file called &lt;code&gt;index.html&lt;/code&gt; with our string &lt;code&gt;"Hello, How are you?"&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Preparation work&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Debian 11 netinstall in a VM is ready (it will be the server)&lt;/li&gt;
&lt;li&gt;The network configuration is ready (IP and port 80 are reachable)&lt;/li&gt;
&lt;li&gt;Root access on the VM&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Some links about the topic I visited before starting the installation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The official website of the HTTP server is noted: &lt;a href="https://httpd.apache.org/"&gt;Apache2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;The documentaion is already under our pillow: &lt;a href="https://httpd.apache.org/docs/2.4/"&gt;Documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;A basic and &lt;strong&gt;safe&lt;/strong&gt; installation is the plan: &lt;a href="https://httpd.apache.org/docs/2.4/misc/security_tips.html"&gt;Security Tips&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;The main site will go to the &lt;code&gt;/var/www/html&lt;/code&gt; directory&lt;/li&gt;
&lt;li&gt;Protecting the system settings and information is a must&lt;/li&gt;
&lt;li&gt;Do &lt;strong&gt;NOT&lt;/strong&gt; allow directory listing for clients&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Installation and configuration&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;SSH to the target server machine&lt;/li&gt;
&lt;li&gt;Use &lt;code&gt;su -&lt;/code&gt; to elevate the privileges to &lt;code&gt;root&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Search for the &lt;code&gt;apache2&lt;/code&gt; package in the Debian apt repo with &lt;code&gt;apt search apache2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;We will find it in the default Debian repository like the followings:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;apache2/stable 2.4.53-1~deb11u1 amd64
  Apache HTTP Server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Install the package with the &lt;code&gt;apt install -y apache2&lt;/code&gt; command&lt;/li&gt;
&lt;li&gt;The HTTP service will start immediately with serving the default Debian Apache2 page&lt;/li&gt;
&lt;li&gt;Stop the service with the &lt;code&gt;systemctl stop apache2&lt;/code&gt; command&lt;/li&gt;
&lt;li&gt;Open the &lt;code&gt;/etc/apache2/apache2.conf&lt;/code&gt; file in a text editor and configure it carefully&lt;/li&gt;
&lt;li&gt;The security related configs will go to the &lt;code&gt;/etc/apache2/conf-enabled/security.conf&lt;/code&gt; file&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ServerTokens&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;ServerTokens&lt;/code&gt; default configuration will display the Operating System and Apache version.
Giving out this information to the possible attackers is not wise. Let them work for getting it. :)&lt;/p&gt;
&lt;p&gt;Setting this option to &lt;code&gt;Prod&lt;/code&gt; will only show that we run an Apache web server.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ServerTokens Prod
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;ServerSignature&lt;/h2&gt;
&lt;p&gt;Pushing our security it even further we can turn off the whole server signature with the following configuration:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ServerSignature Off
ServerTokens Prod
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After reloading the Apache configuration the service will not give out any hints about our system and server version.&lt;/p&gt;
&lt;h2&gt;Directory listing&lt;/h2&gt;
&lt;p&gt;By the default configuration in the lack of an index file Apahce will show the contents of the directory.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;We do not want it at all!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;With the &lt;code&gt;-Indexes&lt;/code&gt; option the browser will get an access denied message.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class="err"&gt;/var/www&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
        Options -Indexes
        Options FollowSymLinks
        AllowOverride None
        Require all denied
&lt;span class="nt"&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;Change the default site&lt;/h1&gt;
&lt;p&gt;Now we can upload our new site that will be served by our Apache2 installation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;rm&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hello, How are you?&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;systemctl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;apache2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Open a browser and check the site!&lt;/p&gt;</content><category term="Linux"></category><category term="linux"></category><category term="http"></category><category term="howto"></category></entry></feed>